<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ãƒã‚¤ã‚¯ã¨MP3å†ç”Ÿ</title>
</head>
<body>
  <h1>ãƒã‚¤ã‚¯ã¨MP3å†ç”Ÿ</h1>

  <p id="mic-status">ãƒã‚¤ã‚¯çŠ¶æ…‹: æœªç¢ºèª</p>

  <!-- ãƒã‚¤ã‚¯ä½¿ç”¨è¨±å¯ãƒœã‚¿ãƒ³ -->
  <button id="mic-btn">ğŸ¤ ãƒã‚¤ã‚¯ã‚’ä½¿ã†</button>

  <!-- éŸ³å£°å†ç”Ÿãƒœã‚¿ãƒ³ -->
  <button id="play-btn">â–¶ï¸ éŸ³å£°ã‚’å†ç”Ÿ</button>

  <!-- MP3 ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ -->
  <audio id="audio-player" loop>
    <source src="./test.mp3" type="audio/mpeg">
    ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ audio ã‚¿ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
  </audio>

  <script>
    // ãƒã‚¤ã‚¯ä½¿ç”¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    async function requestMicrophoneAccess() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        document.getElementById("mic-status").textContent = "ãƒã‚¤ã‚¯çŠ¶æ…‹: ä½¿ç”¨è¨±å¯ã•ã‚Œã¾ã—ãŸ";
        // ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’ä½¿ç”¨ã—ãªã„ãªã‚‰åœæ­¢
        stream.getTracks().forEach(track => track.stop());
      } catch (err) {
        document.getElementById("mic-status").textContent = "ãƒã‚¤ã‚¯çŠ¶æ…‹: è¨±å¯ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ";
        console.error("ãƒã‚¤ã‚¯ã‚¢ã‚¯ã‚»ã‚¹ã‚¨ãƒ©ãƒ¼:", err);
      }
    }

    // å†ç”Ÿå‡¦ç†
    function playAudio() {
      const audio = document.getElementById("audio-player");
      audio.play().then(() => {
        console.log("å†ç”Ÿé–‹å§‹");
      }).catch(err => {
        console.error("å†ç”Ÿã«å¤±æ•—:", err);
      });
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²
    document.getElementById("mic-btn").addEventListener("click", requestMicrophoneAccess);
    document.getElementById("play-btn").addEventListener("click", playAudio);
  </script>
</body>
</html>
